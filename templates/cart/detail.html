{% extends "base.html" %}
{% block content %}

<h1 class="mb-4 fw-bold text-center">Your Shopping Cart ðŸ›’</h1>

{% if cart|length > 0 %}
<div class="row g-4">

    <!-- CART ITEMS -->
    <div class="col-lg-8">
        <div class="card cart-card shadow-lg border-0 overflow-hidden">
            <div class="card-body p-0">

                <div class="table-responsive">
                    <table class="table align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th class="ps-4">Product</th>
                                <th>Price</th>
                                <th>Qty</th>
                                <th>Total</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>

                            {% for item in cart %}
                            <tr class="cart-row">
                                <td class="ps-4">
                                    <div class="d-flex align-items-center gap-3">
                                        <div class="cart-img-wrap">
                                            <img src="{{ item.product.image.url }}"
                                                 alt="{{ item.product.title }}">
                                        </div>
                                        <div>
                                            <h6 class="mb-1">
                                                <a href="{{ item.product.get_absolute_url }}"
                                                   class="text-decoration-none text-dark fw-semibold">
                                                    {{ item.product.title }}
                                                </a>
                                            </h6>
                                            <small class="text-muted">{{ item.product.category.name }}</small>
                                        </div>
                                    </div>
                                </td>

                                <td class="fw-semibold">${{ item.price }}</td>

                                <td>
                                    <span class="qty-pill">{{ item.quantity }}</span>
                                </td>

                                <td class="fw-bold text-dark">${{ item.total_price }}</td>

                                <td class="text-end pe-4">
                                    <a href="{% url 'cart:cart_remove' item.product.id %}"
                                       class="remove-btn"
                                       title="Remove Item">
                                        <i class="fa-solid fa-trash"></i>
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}

                        </tbody>
                    </table>
                </div>

            </div>
        </div>

        <div class="mt-4">
            <a href="/" class="btn btn-outline-secondary">
                <i class="fa-solid fa-arrow-left me-2"></i> Continue Shopping
            </a>
        </div>
    </div>

    <!-- ORDER SUMMARY -->
    <div class="col-lg-4">
        <div class="card summary-card shadow-lg border-0 sticky-top" style="top:120px;">
            <div class="card-body p-4">

                <h4 class="fw-bold mb-4">Order Summary</h4>

                <div class="d-flex justify-content-between mb-2">
                    <span>Subtotal</span>
                    <span>${{ cart.get_total_price }}</span>
                </div>

                <div class="d-flex justify-content-between mb-2">
                    <span>Shipping</span>
                    <span class="text-success">Free</span>
                </div>

                <div class="d-flex justify-content-between mb-2">
                    <span>Tax</span>
                    <span>$0.00</span>
                </div>

                <hr>

                <div class="d-flex justify-content-between mb-4">
                    <span class="fs-5 fw-bold">Total</span>
                    <span class="fs-5 fw-bold total-glow">${{ cart.get_total_price }}</span>
                </div>

                <!-- CHECKOUT -->
                <div class="d-grid">
                    <a href="{% url 'store:checkout' %}" class="btn btn-primary btn-lg checkout-btn">
                        Proceed to Checkout
                    </a>
                </div>

            </div>
        </div>
    </div>

</div>

{% else %}

<!-- EMPTY CART -->
<div class="text-center py-5">
    <div class="mb-4 text-muted">
        <i class="fa-solid fa-cart-shopping fa-4x"></i>
    </div>
    <h3 class="fw-bold">Your cart is empty</h3>
    <p class="text-muted mb-4">Looks like you havenâ€™t added anything yet.</p>
    <a href="/" class="btn btn-primary px-4">Start Shopping</a>
</div>

{% endif %}

<!-- CUSTOM STYLES -->
<style>
    /* CART WRAPPER */
    .cart-card {
        border-radius: 20px;
        animation: fadeUp .4s ease;
    }

    @keyframes fadeUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* PRODUCT IMAGE */
    .cart-img-wrap {
        width: 60px;
        height: 60px;
        background: white;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        box-shadow: 0 8px 18px rgba(0,0,0,.15);
    }

    .cart-img-wrap img {
        max-width: 100%;
        transition: .3s ease;
    }

    .cart-row:hover img {
        transform: scale(1.1);
    }

    /* QUANTITY PILL */
    .qty-pill {
        padding: 4px 12px;
        border-radius: 999px;
        background: #f1f5f9;
        border: 1px solid #e5e7eb;
        font-weight: 600;
        font-size: .9rem;
    }

    /* REMOVE BUTTON */
    .remove-btn {
        color: #dc2626;
        transition: .2s ease;
    }

    .remove-btn:hover {
        color: #b91c1c;
        transform: scale(1.15);
    }

    /* SUMMARY CARD */
    .summary-card {
        border-radius: 22px;
        background: #f8fafc;
    }

    /* TOTAL GLOW */
    .total-glow {
        color: #667eea;
        animation: glow 1.5s infinite alternate;
    }

    @keyframes glow {
        from { text-shadow: 0 0 0 rgba(102,126,234,.4); }
        to { text-shadow: 0 0 12px rgba(102,126,234,.8); }
    }

    /* CHECKOUT BUTTON */
    .checkout-btn {
        box-shadow: 0 15px 35px rgba(102,126,234,.4);
        transition: .3s ease;
    }

    .checkout-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 25px 60px rgba(102,126,234,.6);
    }
</style>

{% endblock %}
